<div align="center">

# 2022 🧭進化計算コンペティション
参加ユーザ[SoraY677](https://github.com/SoraY677/)の最適化リゾルバソース

### 公式サイト：https://ec-comp.jpnsec.org/ja

</div>

---

# 【群集シミュレーションを用いた発生交通量推定】

## 概要

> (公式より)

群集シミュレーションとはカメラやGPSなどの観測情報をもとに，コンピュータ上で歩行者の動きを模擬する技術です．高精度なシミュレーションを行うためには， **「いつ」・「どこからどこへ」・「どのような人が」** といった現実の歩行者情報を正しく再現する必要があります．しかし，数千～数万人規模の人流が発生するイベントにおいて，これらの歩行者情報を正確に計測することは困難です．仮想世界と現実世界のギャップを埋めるためには，不十分な実観測データから正しい歩行者情報を推定しなくてはいけません．<br>
<br>
本コンペティションでは，あるイベントから帰宅する歩行者の観測データをもとに，正しい歩行者情報を推定する最適化問題を扱います．与えられた任意の歩行者情報から得られた群集シミュレーション結果と観測データの誤差を最小化することで， **歩行者の出発時刻，経路選択に関する歩行者モデル** を推定します．<br>
<br>

- 公式詳細：https://ec-comp.jpnsec.org/ja/competitions/eccomp2022
- 山口要約：https://github.com/SoraY677/eccomp2022/blob/develop/doc/概要-山口要約.md

### 提出

#### 単目的問題 - 1
- デモ：https://ec-comp.jpnsec.org/ja/matches/50
- 問題：https://ec-comp.jpnsec.org/ja/matches/51
##### 【最適化対象】
時刻ごとの各エージェントタイプの出発人数
##### 【入力フォーマット例】
```
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,15,15,15,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,22,22,22,22,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,19,19,19,19,19,19,18,18,18,18,18,18,17,17,17,17,17,16,16,16,16,16,15,15,15,15,14,14,14,14,14,13,13,14,13,13,12,12,12,12,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
```
##### 【出力フォーマット】
JSON
|key|value|
|:---:|:----|
|`id`|各解に割り振られる固有のid|
|`objective`|目的関数値|
|`constraint`|制約条件1, 2に対する違反量が入ります．実行可能解は両方の違反量が0|
|`info`|各Tracked Agentに対する評価値|
|`score`|これまでのうちの最小目的関数値|
|`evaluation_error`|シミュレーションの実行時にエラーが発生した場合のエラーメッセージ|
|`scoring_error`|ミュレーション結果を出力フォーマットに変換する際にエラーが発生した場合のエラーメッセージ|

#### 単目的問題 - 2
- デモ：https://ec-comp.jpnsec.org/ja/matches/85
- 問題：https://ec-comp.jpnsec.org/ja/matches/52
##### 【最適化対象】
各時間に出発した人数・歩行者の属性（エージェントタイプ）の推定
##### 【入力フォーマット例】
```
[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,15,15,15,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,22,22,22,22,22,22,22,22,22,22,22,22,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,19,19,19,19,19,19,18,18,18,18,18,18,17,17,17,17,17,16,16,16,16,16,15,15,15,15,14,14,14,14,14,13,13,14,13,13,12,12,12,12,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
```
##### 【出力フォーマット】
JSON
|key|value|
|:---:|:----|
|`id`|各解に割り振られる固有のid|
|`objective`|目的関数値|
|`constraint`|制約条件1, 2に対する違反量が入ります．実行可能解は両方の違反量が0|
|`info`|各Tracked Agentに対する評価値|
|`score`|これまでのうちの最小目的関数値|
|`evaluation_error`|シミュレーションの実行時にエラーが発生した場合のエラーメッセージ|
|`scoring_error`|ミュレーション結果を出力フォーマットに変換する際にエラーが発生した場合のエラーメッセージ|

## dev

### 開発環境

- [Python](https://www.python.org/) v3.8.13 
  - `python -V`
- Makefile
  - [for Windows](https://gnuwin32.sourceforge.net/packages/make.htm)
- Windows 11Home
- 
なお[Anaconda](https://www.anaconda.com/products/distribution)を用いて仮想環境にて開発

### 環境構築

```bash
# Anacondaの環境を作成（最初だけ実行）
$ conda create -n eccomp2022 python=3.8

# Anacondaの環境を有効化
$ conda activate eccomp2022

# pythonの必要モジュールインストール
$ pip install -r requirements.txt

# システム起動 (練習モード)
# 実行時の詳しいオプション設定は後述
$ python main.py

# pythonモジュールを書き出し
$ pip freeze > requirements.txt

# Anacondaの環境を無効化
$ conda deactivate

# Anacondaの環境を削除
$ conda remove -n eccomp2022 --all
```

### 実行時のオプション

|	OptionName	|	Option			|	detail 																					|
|	:--:				|	:---:				|	:----																						|
|	submit-mode	| `-practice` |	submit using mock(Not send solution to server)	|
| 		 				| `-demo`			| submit demo  																		|
|							| `-prod`			| submit production mode													|
|	sop or mop	|	`-sop`			| single purpose problem													|
|							|	`-mop`			| multi  purpose problem													|
| quest-num		|	`-1`				| question 1																			|
|							| `-2`				| question 2																			|
|	is-clear		| `-clear`		| log clear																				|

#### default

- `submit-mode`	: practice
- `sop or mop`	: sop
- `quest-num` 	: 1
- `is-clear`		: clear file

### ディレクトリ構成

```
/doc: ドキュメント
/src: ソースコード
  /resolver: リゾルバ全般
	  - genetic_algorithms: GA
	- config.py: 設定ファイル読み込み
	- config.yml: 設定ファイル
	- submit.py: 解提出
- main.py: 実装のメイン処理全般
- Makefile: コマンド周りの整理
- README.md
```

</details>

## ドキュメント

- 山口要約：https://github.com/SoraY677/eccomp2022/blob/develop/doc/概要-山口要約.md
- 最適化方針：TODO
